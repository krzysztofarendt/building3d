![Unit tests](https://github.com/krzysztofarendt/building3d/actions/workflows/unit_tests.yml/badge.svg)
[![Coverage Status](https://coveralls.io/repos/github/krzysztofarendt/building3d/badge.svg?branch=main)](https://coveralls.io/github/krzysztofarendt/building3d?branch=main)

# building3d

I'm not sure where this project is heading, so there is no documentation yet, but it looks as follows:
<video src='https://github.com/user-attachments/assets/cb29fb3d-299e-4e1e-a090-a842505a699d'>

# Assumptions

Geometry:
- a set of points defines a polygon
- a set of polygons defines a wall
- a set of walls defines a solid (3D space fully enclosed with polygons)
- a set of solids defines a zone
- a set of zones defines a building
- wall polygons do not have to be coplanar
- wall can have subpolygons (e.g. wall with a window)
- subpolygons do not have own meshes (yet)
- solids of a zone need to be adjacent
- but zones of a building do not need to be adjacent
- polygon names within a wall must be unique
- wall names within a solid must be unique
- solid names within a zone must be unique
- zone names within a building must be unique
- but names across parent objects do not need to be unique

Mesh:
- three types of meshes exist:
    1. surface generated by the ear-clipping algorithm
    2. surface mesh generated by Delaunay tesselation
    3. volume mesh generated by Delaunay tesselation
- Type 1. mesh is based solely on the polygon vertices
- Types 2. and 3. use additional vertices inserted into the model. These meshes
  are used for simulations.
- Surface and volume meshes do not necessarily share their vertices (but mostly
  they do)
- Volume meshes of adjacent solids do not necessarily share their vertices at
  the adjacent surfaces (but mostly they do)


# Installation
```
python3.10 -m venv venv
source venv/bin/activate
pip install -e .[dev]
sudo apt install cloc  # for source code line counting
```

# Testing

Run unit tests:
```
make test
```

Produce a coverage report:
```
make coverage
```

# Examples
```
make example_1
make example_2
make example_3
make example_4
```

# Notes

- The meshing algorithms from this package are slow and may produce low quality meshes
  for complex geometries
- Professional meshing tools (gmsh, tetgen, CGAL), however, are licensed under GPL/LGPL/AGPL,
  while I strive to keep this package under the MIT license

# Roadmap

- [x] Connecting solids with different dimensions through polygon slicing -> Add examples then mark done
- [ ] Export to OBJ: https://fegemo.github.io/cefet-cg/attachments/obj-spec.pdf
- [ ] Polygon slice extrusion
- [ ] Predefined wedge geometry
- [ ] Ray-tracing for light
- [ ] Extend ray-tracing to sound (scattering, diffraction)
- [ ] Finite/Control Volume Method for energy simulation
- [ ] Export mesh to VTK format to enable convertions with meshio: https://vtk.org/wp-content/uploads/2015/04/file-formats.pdf

Validation:
- https://www.comsol.com/blogs/validating-an-acoustic-ray-tracing-simulation-of-a-chamber-music-hall

Other cool projects:
- https://github.com/LCAV/pyroomacoustics
- https://gitlab.com/drj11/pypng
- https://glumpy.github.io/index.html
- https://vispy.org/
- https://github.com/pygfx/pygfx
- https://github.com/Kitware/trame
- https://github.com/meshpro/pygalmesh
- https://github.com/nschloe/meshio
- https://reuk.github.io/wayverb/
- https://github.com/pvlib/pvlib-python/tree/main
- https://github.com/mmatl/pyrender
